---
title: Troubleshooting Pivotal Cloud Foundry FIM Add-on
owner: Security Engineering
---

<strong><%= modified_date %></strong>

This topic provides instructions to verify that File Integrity Monitoring Add-on for PCF works with your Pivotal Cloud Foundry (PCF) 
deployment and general recommendations for troubleshooting.


## <a id='about-troubleshoot-fim'></a>About Troubleshooting FIM

This topic provides help for troubleshooting the runtime behavior, to ensure that the deployment is being protected in the way
you expect.

## <a id="bosh-deploy-issues"></a>BOSH Deploy Issues

### Symptom

The FIM add-on generates too much syslog activity during BOSH deploys.

### Explanation

The FIM add-on monitors and reports file changes. BOSH deployments often make changes to the monitored directories and files, 
which generates corresponding FIM syslog activity during the deployment.

The FIM add-on watches for unexpected file changes in all the directories that you configure it to monitor. 
The default manifest configuration monitors files in many critical directories including `/var/vcap/data/jobs`
 and `/var/vcap/data/packages`. 
These directories are critical to the normal operation of PCF and are monitored because they are not expected to change during operation of the platform (between BOSH deploys).

Syslog messages generated during a BOSH deploy report file changes in the `jobs` and `packages` folders in `/var/vcap/...`.  BOSH 
deploys update the files in these folders. Thus, the FIM add-on reports filesystem events that are expected. 
You can consider these syslog messages either as confirmation of a succeeding BOSH deployment or as false positive events.

### Solution

Events occurring during a planned BOSH deployments are normal and may be safely ignored.

To avoid the additional syslog traffic during a BOSH deploy, customize the FIM release deployment manifest to narrow the scope of FIM 
so that it does not include directories affected by deployments. 
You can do this either before you deploy BOSH (as a temporary measure) or as part of the normal FIM configuration.
Consider your threat environment and risk tolerance and configure FIM add-on accordingly. 

## <a id="fim-runtime-issues"></a>FIM Add-on Runtime Issues

### Symptom

Filesystem events are not reported. The logs are empty.

### Explanation:

The FIM add-on might not be running or might be misconfigured.

### Solution

* Check whether `fim` is running. `monit summary` should return the following output on success.

    <pre class='terminal'>The Monit daemon 5.2.5 uptime: 1d 20h 11m<br> 
    Process 'fim'                       running</pre>

* If the process isn't running, inspect the contents of `/var/vcap/sys/log/fim/fim.std*.log` files for clues.

<hr>

### Symptom

Filesystem events are not reported from a portion of the filesystem.

### Explanation:

The FIM add-on is configured to monitor a set of critical directories in the system. It is not configured to monitor the entire filesystem by default.

### Solution

Refer to this [configuration section](/addon-fim/configuration.html#dirs) for inspecting defaults and instructions on adjusting the list in the runtime manifest.

### Symptom

Filesystem events are noisy during a BOSH deployment.

### Explanation:

The FIM add-on reports a high volume of activity during deployments if there is a lot of file creation or deletion.

### Solution

As a workaround, consider suppressing FIM-based alarms at deployment times.
<hr>
